 <div class="max-w-7xl mx-auto space-y-6">
    <div class="flex items-center justify-between mt-4">
      <h1 class="text-2xl font-semibold">Utilisateurs</h1>
    </div>
    
    <form class="card p-6 flex flex-wrap gap-4 items-end" (ngSubmit)="applyFilters()">
      <div class="flex-1 min-w-[200px]">
        <label class="text-xs text-muted">Recherche</label>
        <input class="input w-full" type="text" [(ngModel)]="query" name="queryFilter" placeholder="Nom, prénom ou email">
      </div>
      <div>
        <label class="text-xs text-muted">Statut</label>
        <select class="input" [(ngModel)]="status" name="statusFilter">
          <option value="ALL">Tous</option>
          <option value="ACTIF">Actif</option>
          <option value="BLOQUE">Bloqué</option>
        </select>
      </div>
      <div>
        <label class="text-xs text-muted">Rôle</label>
        <select class="input" [(ngModel)]="role" name="roleFilter">
          <option value="ALL">Tous</option>
          <option value="CLIENT">Client</option>
          <option value="PRO">Professionnel</option>
        </select>
      </div>

      <div class="flex gap-2">
        <button class="btn-primary h-10" type="submit">Filtrer</button>
        <button class="btn-ghost h-10" type="button" (click)="resetFilters()">Réinitialiser</button>
      </div>
    </form>
    <div class="text-sm text-muted">Total: {{ total }}</div>
    <div class="card p-0 overflow-hidden">
      <table class="w-full text-sm">
        <thead class="bg-gray-50">
          <tr>
            <th class="text-left px-4 py-3">Utilisateur</th>
            <th class="text-left px-4 py-3">Email</th>
            <th class="text-left px-4 py-3">Rôles</th>
            <th class="text-left px-4 py-3">Statut</th>
            <th class="text-left px-4 py-3">Créé</th>
            <th class="text-right px-4 py-3">Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (u of items; track u.id) {
            <tr class="border-t">
              <td class="px-4 py-3">
                <div class="flex items-center gap-3">
                  <div class="w-8 h-8 rounded-full text-white flex items-center justify-center"
                       [class]="avatarBg(u.id)">
                    {{ initials(u.prenom + ' ' + u.nom) }}
                  </div>
                  <div>
                    <div class="font-medium">{{ u.prenom }} {{ u.nom }}</div>
                  </div>
                </div>
              </td>
              <td class="px-4 py-3">{{ u.email }}</td>
              <td class="px-4 py-3">
                @for (r of u.roles; track r) {
                  <span class="badge bg-primary/10 text-primary mr-1">{{ r }}</span>
                }
              </td>
              <td class="px-4 py-3">
                <span [ngClass]="statusBadge(u.statut)">{{ u.statut }}</span>
              </td>
              <td class="px-4 py-3">{{ u.createdAt | date:'yyyy-MM-dd HH:mm' }}</td>
              <td class="px-4 py-3 text-right">
                <a class="btn-ghost h-9 mr-2" [routerLink]="['/admin/users', u.id]">Voir</a>
                @if (u.statut !== 'ACTIF') {
                  <button class="btn-primary h-9 mr-2" (click)="activate(u)">Activer</button>
                }
                @if (u.statut !== 'BLOQUE') {
                  <button class="btn-ghost h-9" (click)="block(u)">Bloquer</button>
                }
              </td>
            </tr>
          }
          @empty {
            <tr><td colspan="7" class="px-4 py-6 text-center text-muted">Aucun résultat</td></tr>
          }
        </tbody>
      </table>
    </div>

    <div class="flex items-center justify-end">
      
      <div class="flex gap-2">
        <button class="btn-ghost h-9" [disabled]="page===0" (click)="load(page-1)">Précédent</button>
        <button class="btn-ghost h-9" [disabled]="(page+1)*size >= total" (click)="load(page+1)">Suivant</button>
      </div>
    </div>
  </div>
